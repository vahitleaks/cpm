
@{
    ViewBag.Title = "Index";
    Layout = null;
}

<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="~/Content/bootstrap.min.css" rel="stylesheet" />
    <link href="~/Content/SweetAlert2/sweetalert2.min.css" rel="stylesheet" />
</head>
<body>
    <div class="container">
        <div class="card mt-5" style="background-color:rgb(242 246 247 /42%); border-radius:10px">
            <div class="card-body p-5">
                <div class="text-center pb-15 px-5  mb-3 mt-3">
                    <img data-imagetype="External" src="https://drive.google.com/uc?id=1ztaajrLfSZk3kUxlHqybzA2zqK46Vmib " height="100" title="CPM Logo">
                </div>
                <div class="card-px text-center">
                    <h2 class="fs-2x fw-bold mb-0 mt-3" style="text-align:center; color:#D97D21; letter-spacing:11px">Dikkat!</h2>
                    <p class="text-gray-400 fs-4 fw-semibold py-4">
                        <font style="font-weight:bold;">"Onayla"</font> veya  <font style="font-weight:bold;">"Reddet"</font> işleminizi tamamlamak için lütfen tıklayınız.Tıklamadığınız takdirde herhangi bir işlem yapılmayacaktır ve 48 saat içerisinde reddedilmeyen servisler onaylanmış olarak kabul edilecektir.
                    </p>
                    <img data-imagetype="External" src="https://drive.google.com/uc?id=1R1wUkc-mvlVOBGB1B2Z8S3gPaJUO300p " title="Reddet" style="width:8rem; margin-right:2rem" id="RejectForm" data-id="">
                    <img data-imagetype="External" src="https://drive.google.com/uc?id=1SoT8FXRI8pmRQkjTCl1wfhqfYIt9VKr6 " title="Onayla" style="width:8rem" id="ConfirmForm" data-id="">
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade bd-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true" id="myModal" data-backdrop="static">
        <div class="modal-dialog modal-lg  modal-dialog-centered">
            <div class="modal-content" style="padding:4rem!important;background-color:#F2F6F7;">
                <div class="row">
                    <div class="col-4 float-left">
                        <img src="~/Images/images/cpm/Group 8859@2x.png" height="150" style="object-fit:contain;" />
                    </div>
                    <div class="col-8 my-auto text-left"><span class="" style="font-weight:bold;font-size:22px;color:#CC1616;">Reddetme işlemini tamamlamak lütfen önce nedenini yazıp  daha sonra "Gönder" tuşuna basınız!</span></div>
                </div>
                <div class="row">
                    <div class="col-12">
                        <span style="color:#667880;">İşlemi tamamlayabilmek içim lütfen reddetme nedenini yazınız...</span>
                        <textarea id="REASONFORREJECTION" name="REASONFORREJECTION" rows="4" class="col-12 mt-2" style="border: none !important;">
                        </textarea>
                    </div>
                </div>
                <div class="row mt-3 mb-5">
                    <div class="col-12 text-right">
                        <button class="btn btn-primary" id="SendDescription" data-id="">Gönder</button>
                    </div>
                </div>
                <div class="row">
                    <div class="col-5">
                        <img src="~/Images/images/cpm/Icon awesome-facebook.png" class="mr-2" style="height:15px;" />
                        <img src="~/Images/images/cpm/Icon awesome-instagram.png" class="mr-2" style="height:15px;" />
                        <img src="~/Images/images/cpm/Icon awesome-linkedin.png" class="mr-2" style="height:15px;" />
                        <img src="~/Images/images/cpm/Icon awesome-twitter.png" class="mr-2" style="height:15px;" />
                        <img src="~/Images/images/cpm/Icon awesome-youtube.png" style="height:15px;" />
                    </div>
                    <div class="col-4">
                        <img src="~/Images/images/cpm/cpm.png" style="object-fit:contain;height:50px;" />
                    </div>
                    <div class="col-3 text-right">
                        <span style="font-size: 12px;">www.cpm.com.tr</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script src="~/Scripts/jquery.min.js"></script>
    <script src="~/Tema/assets/js/bootstrap.bundle.min.js" charset="windows-1254" type="text/javascript"></script>
    <script src="~/Scripts/bootstrap.min.js"></script>
    <script src="~/Tema/assets/plugins/sweet-alert2/sweetalert2.min.js"></script>
    <script>
        $(document).ready(function ()
        {
            var myModal = new bootstrap.Modal(document.getElementById('myModal'), {
                keyboard: false
            });
            //#region Reddet  Tıkla
            $('body').on('click', '#RejectForm', function ()
              
            {
                debugger;
                var SERVICEFORMID = $(this).attr("data-id");
                $.ajax({
                    type: 'POST',
                    url: "/ServiceFormOnay/CheckStateForm",
                    dataType: "json",
                    data:
                    {
                        'SERVICEFORMID': SERVICEFORMID,
                        'ControlState': 0
                    },
                    success: function (result) 
                    {
                        if (result.IsSuccess) {
                            myModal.show();
                        }
                        else
                        {
                            alert(result.Message);
                        }
                    },
                    error: function (xhr)
                    {
                        alert('error');
                    }
                });
               
            });
            
            //#endregion
            //#region Reddet-Açıklama Kaydet
            $('body').on('click', '#SendDescription', function ()
            {
                var SERVICEFORMID = $("#RejectForm").attr("data-id");
                var REASONFORREJECTION = $("#REASONFORREJECTION").val().trim();
                if (REASONFORREJECTION == '') {

                    alert('Lütfen reddetme nedenini yazınız...');
                }
                else {
                    $.ajax({
                        type: 'POST',
                        url: "/ServiceFormOnay/Reject",
                        dataType: "json",
                        data:
                        {
                            'SERVICEFORMID': SERVICEFORMID,
                            'REASONFORREJECTION': REASONFORREJECTION
                        },
                        success: function (result) {
                            if (result.IsSuccess)
                            {
                                myModal.hide();
                                window.close();
                            }
                            else {
                                alert(result.Message);
                            }
                        },
                        error: function (xhr) {
                            alert('error');
                        }
                    });

                }
            });
            //#endregion
            //#region Onayla  Tıkla
            $('body').on('click', '#ConfirmForm', function ()
            {
                var SERVICEFORMID = $(this).attr("data-id");
                $.ajax({
                    type: 'POST',
                    url: "/ServiceFormOnay/CheckStateForm",
                    dataType: "json",
                    data:
                    {
                        'SERVICEFORMID': SERVICEFORMID,
                        'ControlState': 1
                    },
                    success: function (result)
                    {
                        if (result.IsSuccess)
                        {
                            $.ajax({
                                type: 'POST',
                                url: "/ServiceFormOnay/Confirm",
                                dataType: "json",
                                data:
                                {
                                    'SERVICEFORMID': SERVICEFORMID
                                },
                                success: function (result)
                                {
                                    if (result.IsSuccess)
                                    {
                                        alert(result.Message);
                                        window.close();
                                    }
                                    else {
                                        alert(result.Message);
                                    }
                                },
                                error: function (xhr) {
                                    alert('error');
                                }
                            });
                        }
                        else
                        {
                            alert(result.Message)
                        }
                    },
                    error: function (xhr) {
                        alert('error');
                    }
                });

            });
            //#endregion

        });
    </script>
</body>
</html>

