@using sistemproject.Models
@model List<sistemproject.Controllers.Node3Step>
<div class="col-12">
    @helper RenderNode(sistemproject.Controllers.Node3Step node)
    {
    <div class="node">
        <i data-icon="" class="icon nodeStateDanger nodeState"  @(node.LastNode == true && node.CurrentState == "Başlanacak" &&  node.Approval == 0 ? "" : "hidden") style=""></i>
        <i data-icon="" class="icon nodeStateWarning nodeState" @(node.LastNode == true && node.CurrentState == "Devam Ediyor" &&  node.Approval == 2 ? "" : "hidden") style=""></i>
        <i data-icon="" class="icon nodeStateSuccess nodeState" @(node.LastNode == true && node.CurrentState == "Tamamlandı" &&  node.Approval == 1 ? "" : "hidden") style=""></i>
        <i data-icon="" class="icon nodeStatePrimary nodeState" @(node.LastNode == true && node.Approval == 3 ? "" : "hidden") style=""></i>
        <h6 class="toggle">
            <span class="@((node.Children != null && node.Children.Count > 0) ? "icontoogle" : "childPadding") tooglePlusButton"></span>
            <label data-ProjectId="@node.ProjectId" data-id="@node.Id" data-GroupNo="@node.GroupNo" data-Step="@node.Step" class="rowEditIcon">
                <a id="ShowStepDetailModal" href="#" data-ProjectId="@node.ProjectId" data-id="@node.Id" data-GroupNo="@node.GroupNo" data-Step="@node.Step" data-State="@node.Approval"
                   class="@((node.Children != null && node.Children.Count > 0) ? "HasChildNode" : "LastNode")">@node.GroupNo @node.Step</a>
            </label>
            <span class="Date font-10">(@(node.StartDate.HasValue ? node.StartDate.Value.ToString("dd.MM.yyyy") : "") - @(node.EndDate.HasValue ? node.EndDate.Value.ToString("dd.MM.yyyy") : ""))</span>
        </h6>
        <ul class="children" style="display:none">
            @foreach (var child in node.Children)
            {
                <li>@RenderNode(child) </li>
            }
        </ul>
    </div>
    }
    @if (Model != null && Model.Count > 0)
    {
        <ul class="treeview">
            @foreach (var node in Model)
            {
                <li>@RenderNode(node)</li>
            }
        </ul>
    }
</div>
<script>
    $(".tooglePlusButton").click(function () {
        $(this).toggleClass("collapsed");
        $(this).parent().siblings(".children").toggle();
    });
</script>